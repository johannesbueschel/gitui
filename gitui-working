#!/bin/bash

# Shows the files in the working directory
get_files="git status --short \
    | awk '/^ M |^MM |^AM |^ D |^\?\? / {print}' \
    | cut -c 4- \
    | sed 's/\"//g'"

git status --short \
    | awk '/^ M |^MM |^AM |^ D |^\?\? / {print}' \
    | cut -c 4- \
    | sed 's/"//g' \
    | fzf \
    --style full +m \
    --reverse \
    --border \
    --border-label " gitui - Working directory " \
    --preview="gitui-preview-working {}" \
    --bind "enter:execute(git add {})+reload($get_files),ctrl-p:execute(git add -p {})+reload($get_files)" \
    --bind "ctrl-r:reload($get_files)" \
    --bind "ctrl-i:become(gitui-index)" \
    --bind "backspace:execute(git restore {})+reload($get_files)"
